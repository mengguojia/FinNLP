from finnlp.data_sources.social_media.weibo_date_range import Weibo_Date_Range
import pandas as pd
import datetime
#%%

config = {
    "use_proxy": "china_free",
    "max_retry": 5,
    "proxy_pages": 10,
    "cookies": ["SCF=AlizMkAJjG9p9Ggq9WaP_7Pc3Pzsh7zZse78lGW1wbFR-_gSXA0yODFRssb0LcgDVxCuTH8FYR4blkKJWnc_hTw.; SUB=_2A25KA-GbDeRhGeNN7FoZ8yjIyj2IHXVpYXtTrDV8PUNbmtAGLRmlkW9NSYd_9SV6VBlp2cfqYXPYZh9obamQ48AG; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W5pzPMaC3iOAi3Ds.XfSumj5NHD95Qfe0MR1hecSh2pWs4Dqcj.i--fiK.RiKn4i--ciKn7i-2pi--fiKyWi-27i--Xi-zRiKn7; ALF=02_1731141323; _s_tentry=weibo.com; Apache=3982410514154.915.1728549343544; SINAGLOBAL=3982410514154.915.1728549343544; ULV=1728549343575:1:1:1:3982410514154.915.1728549343544:",
                "SCF=AmxRZxzFdE6QnVRUsluiViIs8yHq2Wswl6AkxAZgUGJz3CWbvRiR7gdg45G8Rpg2wPwrx6cS5JU7PNWADSfCFE8.; SUB=_2A25KA-JjDeRhGeFH6loS8SfOzDSIHXVpYXurrDV8PUNbmtANLXLzkW9Ne98MBT6iLUi_c7U3_3UyUiNm5XF5OYzR; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W59LmVM7.KqJ2caMVZSGlcV5NHD95QN1K2Re024eoMRWs4DqcjMi--NiK.Xi-2Ri--ciKnRi-zNS0.p1hep1KzN15tt; ALF=02_1731141427; _s_tentry=weibo.com; Apache=9125169551757.076.1728549450511; SINAGLOBAL=9125169551757.076.1728549450511; ULV=1728549450539:1:1:1:9125169551757.076.1728549450511:",
                "SCF=AoNFMMeBD_EK-1mYSm9tAdG9BQzZD24v0RTdER-Bk44-T8JTYI7ClsyssFpw0YGXuOhWiCdYuvX-SEc8dM0LdaU.; SUB=_2A25KA-CaDeRhGeVM61UZ8yjIzj-IHXVpYXxSrDV8PUNbmtAGLXb1kW9NTQsmEQEjg3x46Il6vNeZBkR80aMyiUlD; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W55S4YENGhgWjGV3G_DMTi95NHD95Q0eo5N1hecSh-0Ws4Dqc_zi--ciKn0i-z0i--Xi-zRiKyFi--NiKnpi-8Fi--NiKyFi-zpi--NiKLWiKnXi--fiKy2i-2pi--RiKysi-zEi--fiKyFiK.E; ALF=02_1731141066; _s_tentry=weibo.com; Apache=195738588899.31683.1728549098325; SINAGLOBAL=195738588899.31683.1728549098325; ULV=1728549098351:1:1:1:195738588899.31683.1728549098325:", #gc
                "SCF=AlCVkcsEAJ6VnMQWpuxzzDC9ihfYhBwa4XcPDkmWfGQv5O5tvIV9R8hoIcBcUEotqyd7xQKIYrMm9k8I7lktd8Q.; SUB=_2A25KA_50DeRhGedJ7lUY-S7Pzz-IHXVpYX-8rDV8PUNbmtANLXKikW9NUf63qokLYqBYaajMphuc0EBarRt14q3P; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9Wh29Uw3YaNQ_mVY7Q6jpPpY5NHD95QpS0-N1K.7e0B0Ws4Dqcjz9gf7UGLkIgBt; ALF=02_1731140388; _s_tentry=weibo.com; Apache=9455572421746.283.1728548411382; SINAGLOBAL=9455572421746.283.1728548411382; ULV=1728548411398:1:1:1:9455572421746.283.1728548411382:", #qyz
                "SCF=AicDibY-UBso24aCYCl8XbWZzM1rXO1vgpBUMcSH-ETYIfcVptW3uhiRhSara851GDfY5UYuDFEzs1Z8s-i5WlY.; SUB=_2A25KA-EmDeRhGeFL6VsR9inJyDuIHXVpYXzurDV8PUNbmtAGLRnZkW9NQihV1xSnJ8NXl_twW5-J2UMzj34Vw7CT; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W5ZwaGJiEGkF_FSJdWkDhyg5JpX5KzhUgL.FoMfeo.7SoMfe0M2dJLoI798ds_LMLYt; ALF=02_1731141237; _s_tentry=weibo.com; Apache=613187914440.2719.1728549256137; SINAGLOBAL=613187914440.2719.1728549256137; ULV=1728549256152:1:1:1:613187914440.2719.1728549256137:", #ws
                "SCF=AlH1O3KT2gMbQebDZaVZbSuouiXtSGh06LUGXkXLiuhqMMPP7x9lrQ-9X7_Sce0OfzCRIuOP0NIuxmcKukHkI2I.; SUB=_2A25KA6ZXDeRhGeFM6FoT-CjPyjSIHXVpYKefrDV8PUNbmtAGLVKjkW9NQMcyG3ovbo8jDoWZnF0wRcEMQQ6OvD7E; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9WFBE40Psv60JHe6yTaYNzdm5JpX5KzhUgL.FoMEe0nE1hq0eKn2dJLoIpQLxKML1KBLBKnLxKqL1hnLBoMpSo-N1hBfe7tt; ALF=02_1731158791; _s_tentry=weibo.com; Apache=1718326148186.6863.1728566808927; SINAGLOBAL=1718326148186.6863.1728566808927; ULV=1728566808947:1:1:1:1718326148186.6863.1728566808927:" #pwp
                ],
}

#%%
downloader = Weibo_Date_Range(config)
keyword = "房地产"
start_date = "2018-01-01"
end_date = "2018-01-31"
date_range = pd.date_range(start_date, end_date, freq="D").strftime('%Y-%m-%d')
for i in range(len(date_range)-1):
    downloader.download_date_range_stock(date_range[i], date_range[i+1], stock = keyword, delay=0.5)
df = downloader.dataframe
df.to_csv(f"{keyword}-{start_date}-{end_date}.csv")
